{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '42469793-94d748bc29f10cf193212e81f';\nconst url = 'https://pixabay.com/api/?';\n\nlet page = 1;\n\nexport async function fetchCards(searchQuery, page = 1) {\n  try {\n    const response = await axios.get(url, {\n      params: {\n      key: apiKey,\n      q: searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n    },\n    });\n    if (!response.data.hits) {\n      throw new Error('Failed to fetch images. Please try again later.');\n    }\n\n    if (page ===1){\n      resetPage();\n    }\n    return response.data;\n  } catch (error) {\n    throw new Error('Failed to fetch images. Please try again later.');\n  }\n}\n\nfunction resetPage(){\n  page = 1;\n}","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const galleryList = document.querySelector('.card-list');\nconst loader = document.querySelector('.loader');\n\nconst instance = new SimpleLightbox('.card-item a', {\n  captionsData: 'alt',\n  captionDelay: 250, \n});\n\nexport function renderCards(data) {\n  if (!data.hits) {\n    return iziToast.error({\n      title: 'Error',\n      message: 'Sorry, there are no images matching your search query. Please try again!',\n      position: 'center',\n    });\n  }\n  const markup = getMarkup(data.hits);\n  galleryList.insertAdjacentHTML('beforeend', markup);\n  instance.refresh();\n}\n\nfunction getMarkup(data) {\n  return data\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"card-item\">\n  <a href=${largeImageURL}\n    ><img src=${webformatURL} alt=\"${tags}\" height=\"200\"/>\n    <ul class=\"card-info\">\n      <li>\n        Likes\n        <p>${likes}</p>\n      </li>\n      <li>\n        Views\n        <p>${views}</p>\n      </li>\n      <li>\n        Comments\n        <p>${comments}</p>\n      </li>\n      <li>\n        Downloads\n        <p>${downloads}</p>\n      </li>\n    </ul></a\n  >\n</li>`\n    )\n    .join('');\n}\n\nexport function toggleLoader() {\n  console.log('toggleLoader');\n  loader.classList.toggle('is-hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchCards } from './js/pixabay-api';\nimport { galleryList, renderCards, toggleLoader } from './js/render-functions';\n\nconst searchForm = document.querySelector('.search-form');\nconst loadMoreBtn = document.getElementById('load-more-btn'); \nlet page = 1;\nlet currentSearchQuery;\nlet totalHits;\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', loadMoreImages);\nloadMoreBtn.classList.add('is-hidden');\n\nfunction renderLoadMoreButton() {\n  loadMoreBtn.classList.toggle('is-hidden', galleryList.children.length === 0 || galleryList.children.length >= totalHits);\n}\n\nasync function loadMoreImages() {\n  page += 1;\n  await fetchData(currentSearchQuery, page);\n  scrollToNewCards();\n}\n\nasync function fetchData(searchQuery, pageNum) {\n  try {\n    toggleLoader();\n    const data = await fetchCards(searchQuery, pageNum);\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'center',\n      });\n    }\n    totalHits = data.totalHits;\n\n    renderCards(data);\n    renderLoadMoreButton();\n\n    if (isLastPage()) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'An unexpected error occurred while fetching images. Please try again.',\n      position: 'center',\n    });\n  } finally {\n    toggleLoader();\n  }\n}\n\nfunction onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  const searchInput = document.querySelector('.search-input');\n  const userSearchQuery = searchInput.value.trim();\n\n  if (userSearchQuery === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a keyword before submitting the form.',\n      position: 'center',\n    });\n    return false;\n  }\n\n  galleryList.innerHTML = '';\n\n  page = 1;\n  currentSearchQuery = userSearchQuery; \n  totalHits = 0;\n  fetchData(userSearchQuery, page);\n}\n\nfunction isLastPage() {\n  return totalHits <= page * 15 && totalHits !== 0;\n}\n\nfunction getCardHeight() {\n  const firstCard = document.querySelector('.card-list li');\n  if (firstCard) {\n    const cardRect = firstCard.getBoundingClientRect();\n    return cardRect.height;\n  }\n  return 0;\n}\n\nfunction scrollToNewCards() {\n  const cardHeight = getCardHeight();\n  if (cardHeight > 0) {\n    window.scrollBy(0, cardHeight * 2);\n  }\n}"],"names":["apiKey","url","fetchCards","searchQuery","page","response","axios","galleryList","loader","instance","SimpleLightbox","renderCards","data","iziToast","markup","getMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","toggleLoader","searchForm","loadMoreBtn","currentSearchQuery","totalHits","onSearchFormSubmit","loadMoreImages","renderLoadMoreButton","fetchData","scrollToNewCards","pageNum","isLastPage","error","event","userSearchQuery","getCardHeight","firstCard","cardHeight"],"mappings":"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"}